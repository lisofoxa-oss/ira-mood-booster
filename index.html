<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò—Ä–∏—à–∞ Mood Booster üíñ</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        #app { padding: 20px; max-width: 400px; margin: 0 auto; }
        h1 { 
            text-align: center; color: #ff6b9d; font-size: 1.8em; 
            margin-bottom: 30px; text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .emoji-grid {
            display: grid; grid-template-columns: repeat(4, 1fr); 
            gap: 15px; margin: 30px 0;
        }
        .emoji-btn {
            width: 70px; height: 70px; border: none; border-radius: 20px;
            font-size: 2em; cursor: pointer; transition: all 0.3s;
            background: rgba(255,255,255,0.8); box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .emoji-btn:hover { transform: scale(1.1); box-shadow: 0 6px 20px rgba(0,0,0,0.2); }
        .emoji-btn.selected { 
            background: #ff6b9d; color: white; transform: scale(1.15); 
            animation: pulse 0.6s infinite;
        }
        @keyframes pulse { 0%, 100% { transform: scale(1.15); } 50% { transform: scale(1.25); } }
        .advice {
            background: white; border-radius: 25px; padding: 30px;
            text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            margin: 30px 0; min-height: 120px; display: flex; align-items: center;
            justify-content: center; font-size: 1.2em; color: #333;
        }
        .generate-btn {
            width: 100%; padding: 18px; border: none; border-radius: 30px;
            background: linear-gradient(45deg, #ff6b9d, #ff8fab); 
            color: white; font-size: 1.3em; font-weight: bold;
            cursor: pointer; transition: all 0.3s; margin: 20px 0;
        }
        .generate-btn:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(255,107,157,0.4); }
        .generate-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .stats { 
            display: flex; justify-content: space-around; margin: 20px 0;
            background: rgba(255,255,255,0.9); padding: 15px; border-radius: 20px;
        }
        .stat { text-align: center; color: #ff6b9d; font-weight: bold; }
        .hearts { position: fixed; top: 0; left: 0; pointer-events: none; z-index: 1000; }
        .heart { 
            position: absolute; font-size: 1.5em; color: #ff6b9d; 
            animation: float 3s ease-out forwards;
        }
        @keyframes float {
            0% { transform: translateY(100vh) scale(0); opacity: 1; }
            100% { transform: translateY(-100px) scale(1); opacity: 0; }
        }
    </style>
</head>
<body>
    <div id="app">
        <h1>–ò—Ä–∏—à–∞ Mood Booster üíñ</h1>
        
        <div class="stats" v-if="stats.todaySmiles > 0">
            <div class="stat">
                –°–µ–≥–æ–¥–Ω—è: {{ stats.todaySmiles }} ‚ú®
            </div>
            <div class="stat">
                –í—Å–µ–≥–æ: {{ stats.totalSmiles }} üíï
            </div>
        </div>

        <div class="emoji-grid">
            <button 
                v-for="(emoji, i) in emojis" :key="i"
                class="emoji-btn" :class="{ selected: selectedEmojis.includes(emoji) }"
                @click="toggleEmoji(emoji)"
                :disabled="selectedEmojis.length >= 3"
            >{{ emoji }}</button>
        </div>

        <button 
            class="generate-btn" 
            :disabled="selectedEmojis.length < 3"
            @click="generateAdvice"
        >
            {{ selectedEmojis.length < 3 ? `–í—ã–±–µ—Ä–∏ ${3-selectedEmojis.length} —ç–º–æ–¥–∑–∏ üíñ` : '–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–æ–≤–µ—Ç! ‚ú®' }}
        </button>

        <div v-if="currentAdvice" class="advice">
            {{ currentAdvice }}
            <div style="margin-top: 15px; font-size: 0.9em; color: #ff6b9d;">
                –°–æ—Ö—Ä–∞–Ω–∏ —É–ª—ã–±–∫—É —Å–µ–≥–æ–¥–Ω—è! üíï
            </div>
        </div>

        <button 
            v-if="currentAdvice" 
            class="generate-btn" style="background: #ff9a9e;"
            @click="shareAdvice"
        >–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –≤ –¢–ì ‚ú®</button>
    </div>

    <div class="hearts" ref="heartsContainer"></div>

    <script>
        const { createApp, ref, computed, onMounted } = Vue;
        
        createApp({
            setup() {
                // –î–∞–Ω–Ω—ã–µ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ 3200+ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–æ–≤–µ—Ç–æ–≤
                const moods = ['üòä –£–ª—ã–±—á–∏–≤–æ–µ', 'üåô –ú–µ—á—Ç–∞—Ç–µ–ª—å–Ω–æ–µ', 'üî• –≠–Ω–µ—Ä–≥–∏—á–Ω–æ–µ', 'üíñ –õ—é–±–æ–≤–Ω–æ–µ', 'üéµ –ú—É–∑—ã–∫–∞–ª—å–Ω–æ–µ', '‚òï –£—é—Ç–Ω–æ–µ', 'üåü –ó–≤—ë–∑–¥–Ω–æ–µ', 'ü¶ã –°–≤–æ–±–æ–¥–Ω–æ–µ'];
                const actions = ['—Ç–∞–Ω—Ü—É–π', '—Ä–∏—Å—É–π', '–ø–∏—à–∏ —Å—Ç–∏—Ö', '–≥—É–ª—è–π', '—Å–ª—É—à–∞–π –ø–ª–µ–π–ª–∏—Å—Ç', '–º–µ—á—Ç–∞–π', '—Ñ–æ—Ç–∫–∞–π', '–æ–±–Ω–∏–º–∞–π –∫–æ—Ç–∏–∫–∞', '–µ—à—å –≤–∫—É—Å–Ω—è—à–∫—É', '–¥—ã—à–∏ –≥–ª—É–±–æ–∫–æ'];
                const details = ['–ø–æ–¥ –∑–≤—ë–∑–¥–∞–º–∏', '—Å –∫–æ—Ñ–µ', '–≤ –Ω–∞—É—à–Ω–∏–∫–∞—Ö', '—Å –ø–æ–¥—Ä—É–∂–∫–∞–º–∏', '–≤ —Ä–æ–∑–æ–≤–æ–º', '–Ω–∞ –∑–∞–∫–∞—Ç–µ', '—Å –º–æ—Ä–æ–∂–µ–Ω—ã–º', '–ø–æ–¥ –¥–æ–∂–¥—ë–º'];
                const bonuses = ['–∏ –º–∏—Ä –∑–∞—Å–∏—è–µ—Ç!', '—Ç—ã —Å—É–ø–µ—Ä–∑–≤–µ–∑–¥–∞!', '–≤—Å—ë –ø–æ–ª—É—á–∏—Ç—Å—è üíï', '—Ç—ã –ª—É—á—à–∞—è!', '—É–ª—ã–±–Ω–∏—Å—å —à–∏—Ä–µ!'];

                const emojis = ['üòä', 'üåô', 'üî•', 'üíñ', 'üéµ', '‚òï', 'üåü', 'ü¶ã', '‚ú®', 'üå∏', 'üê±', 'üéÄ'];
                const selectedEmojis = ref([]);
                const currentAdvice = ref('');

                // localStorage –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
                const stats = ref({
                    todaySmiles: 0,
                    totalSmiles: 0,
                    lastDate: ''
                });

                const loadStats = () => {
                    const saved = localStorage.getItem('iraMoodStats');
                    if (saved) {
                        stats.value = JSON.parse(saved);
                        const today = new Date().toDateString();
                        if (stats.value.lastDate !== today) {
                            stats.value.todaySmiles = 0;
                            stats.value.lastDate = today;
                        }
                    } else {
                        const today = new Date().toDateString();
                        stats.value.lastDate = today;
                        saveStats();
                    }
                };

                const saveStats = () => {
                    localStorage.setItem('iraMoodStats', JSON.stringify(stats.value));
                };

                const toggleEmoji = (emoji) => {
                    const idx = selectedEmojis.value.indexOf(emoji);
                    if (idx > -1) {
                        selectedEmojis.value.splice(idx, 1);
                    } else if (selectedEmojis.value.length < 3) {
                        selectedEmojis.value.push(emoji);
                    }
                };

                const generateAdvice = () => {
                    const moodIdx = Math.floor(Math.random() * moods.length);
                    const actionIdx = Math.floor(Math.random() * actions.length);
                    const detailIdx = Math.floor(Math.random() * details.length);
                    const bonusIdx = Math.floor(Math.random() * bonuses.length);
                    
                    currentAdvice.value = `${moods[moodIdx]} –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ? ${actions[actionIdx]} ${details[detailIdx]} ${bonuses[bonusIdx]}`;
                    
                    stats.value.todaySmiles++;
                    stats.value.totalSmiles++;
                    saveStats();
                    
                    // –ê–Ω–∏–º–∞—Ü–∏—è —Å–µ—Ä–¥–µ—á–µ–∫
                    createHearts();
                };

                const createHearts = () => {
                    for (let i = 0; i < 8; i++) {
                        setTimeout(() => {
                            const heart = document.createElement('div');
                            heart.className = 'heart';
                            heart.innerHTML = ['üíñ', '‚ú®', 'üå∏'][Math.floor(Math.random() * 3)];
                            heart.style.left = Math.random() * 100 + '%';
                            heart.style.animationDuration = (Math.random() * 2 + 2) + 's';
                            document.querySelector('.hearts').appendChild(heart);
                            setTimeout(() => heart.remove(), 4000);
                        }, i * 100);
                    }
                };

                const shareAdvice = () => {
                    if (window.Telegram?.WebApp) {
                        Telegram.WebApp.showAlert('–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ —Ç–≤–æ–∏ –ª—é–±–∏–º—ã–µ –º–æ–º–µ–Ω—Ç—ã! üíï');
                    } else {
                        navigator.clipboard.writeText(currentAdvice.value);
                        alert('–°–æ–≤–µ—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω! –ü–æ–¥–µ–ª–∏—Å—å —Å –¥—Ä—É–∑—å—è–º–∏ üíñ');
                    }
                };

                onMounted(() => {
                    loadStats();
                    if (window.Telegram?.WebApp) {
                        Telegram.WebApp.expand();
                        Telegram.WebApp.MainButton.setText('–ù–æ–≤—ã–π —Å–æ–≤–µ—Ç üíï').show().onClick(generateAdvice);
                    }
                });

                return {
                    emojis, selectedEmojis, currentAdvice, stats,
                    toggleEmoji, generateAdvice, shareAdvice
                };
            }
        }).mount('#app');
    </script>
</body>
</html>
